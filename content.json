[{"title":"博客添加spine模型避坑指南【FRD 02】","path":"spineModel/","text":"前言心血来潮想给网页右下角添加明日方舟小人模型，我知道明日方舟的模型是基于spine3.8的 在Hexo博客里放一只明日方舟小人的SpineModel中提供了详细教程，发布日期也很近，但我依然在操作过程中遇到了麻烦，因此分享一下避坑经验 注意：本教程需要你拥有spine 3.8.x软件，学习版请自己上网查找 正文我的目录结构 此教程通过scripts文件夹下的文件利用hexo自带的劫持功能实现 除了模型文件，其他的在前言部分的文章中均已提供 文件处理models文件夹下面的文件需要去prts.wiki下 具体方法是加载网页，F12打开开发工具，网络选项卡，点击页面的载入模型按钮，即可看到相关文件，双击即可下载下来 避坑点1：2025.04后明日方舟所有的基建模型都更新了，atlas对不上png文件，在使用spine解包纹理时会出错，你需要手动缩放png文件，或前往Arknights Spine Models (Excerpt) | 明日方舟Spine动画小人模型(节选) 下载已经处理完毕的png文件 避坑点2：下载下来的文件名不要改，github下下来的png文件名有可能是修改过的，你需要改回prtswiki下下来的文件名，因为spine的纹理图集和贴图文件名是绑定的 理论上来讲此时已经可以直接把这些文件扔进去了，但是我这边会出现部分贴图错误的问题 这种情况要打开spine，最好是管理员身份，左上角-纹理解包器，指定一个无中文目录（如果不这样做会遇到未知错误）解包，然后再使用内置的纹理打包器重新打包一遍，得到新的atlas和png文件，覆盖之前下载下来的 代码处理在spine-widget.js中，最好把有关js文件地址修改为自己的spine-player.js中 1const spine_model_path = &quot;/path/spine/models/&quot;; 修改成你自己的模型路径 12345var MODELS = [ // 模型列表 &quot;model1&quot;,// 可用模型列表 &quot;model2&quot;, &quot;model3&quot;,]; 这里需要填入你下载下来的文件名，不需要后缀例如我的是build_char_017_huang_witch_5 build_char_017_huang build_char_017_huang_as_1 build_char_1040_blaze2 123456var MODELS = [ // 模型列表 &quot;build_char_017_huang_witch_5&quot;, &quot;build_char_017_huang&quot;, // 可用模型列表 &quot;build_char_017_huang_as_1&quot;, &quot;build_char_1040_blaze2&quot;,]; 里面的模型每刷新一次就会随机更换 修复搜索冲突可能是spine-player.js中全局变量的问题，导致搜索功能出现问题 解决方法 123(function()&#123; /*原有代码*/&#125;)(); 像这样在原有代码基础上，再套一层function()即可 模型显示大小调整spine-widget.css 12width: 400px;height: 400px; spine-widget.js 12canvas.width = 400;canvas.height = 400; 修改成你想要的，默认分别是250x250，300x300 我建议都调成300x300，我自己用的是400x400 当然参数怎么调看你的心意，只是太大会很糊"},{"title":"hexo新版nexmoe主题加入aplayer 引入pjax防止切换页面刷新【FRD 01】","path":"aplayerWithPjax/","text":"前言加入aplayer（metingJS）实现在网页右下角添加播放器后，出现了切换页面刷新后音乐中断，进度丢失的问题，进而需要引入pjax实现切换页面不刷新 参考来源：Aplayer+MetingJS+Pjax&#x3D;网“页”云音乐 但是文章中使用layout布局文件是完整的ejs文件，而新版的nexmoe主题（大约是4.1.5后）已经将其拆分成了多个文件，其中layout变成了jsx文件，目录结构也有所改变 经过尝试已经完成修改并成功完成，（大）部分代码来源于Deepseek，简单做一下分享 2025.05.31更新：原有方法对模板文件破坏太大，存在低级问题且不易维护，现已重构代码 新的代码使用aplayer原生播放模式，如果需要利用meting.js可以参考下文中旧的代码 修改部分（新）自定义js初始化播放器和pjax 把下面这个文件放在/source/js/下 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071// 全局播放器实例let globalPlayer = null;// 初始化播放器function initPlayer() &#123; if (!globalPlayer) &#123; globalPlayer = new APlayer(&#123; container: document.getElementById(&#x27;aplayerallpages&#x27;), fixed: true, autoplay: false, theme: &#x27;#FADFA3&#x27;, loop: &#x27;all&#x27;, order: &#x27;random&#x27;, preload: &#x27;auto&#x27;, volume: 0.7, mutex: true, lrcType: 0, audio: [&#123;name: &#x27;example1&#x27;,artist: &#x27;example&#x27;,url: &#x27;/music/example1.mp3&#x27;,cover:&#x27;cover1.png&#x27;&#125;, &#123;name: &#x27;example2&#x27;,artist: &#x27;example&#x27;,url: &#x27;/music/example2.mp3&#x27;,cover:&#x27;cover2.png&#x27;&#125;] &#125;); &#125; return globalPlayer;&#125;// 初始化 PJAXfunction initPjax() &#123; $(document).pjax(&#x27;a:not([target=&quot;_blank&quot;], .no-pjax)&#x27;, &#x27;#pjax-container&#x27;, &#123; fragment: &#x27;#pjax-container&#x27;, timeout: 8000 &#125;);&#125;// DOM 就绪后初始化document.addEventListener(&#x27;DOMContentLoaded&#x27;, function() &#123; initPlayer(); // 确保 PJAX 依赖已加载 if (window.$ &amp;&amp; $.fn.pjax) &#123; initPjax(); &#125; else &#123; console.warn(&#x27;PJAX 依赖未加载&#x27;); &#125;&#125;);$(document).on(&#x27;pjax:complete&#x27;, function(event) &#123; reloadSidebarMenu();&#125;);function reloadSidebarMenu() &#123; $.ajax(&#123; url: window.location.href, type: &#x27;GET&#x27;, dataType: &#x27;html&#x27;, success: function(fullPageHtml) &#123; // 从完整页面中提取侧边栏菜单 const $newContent = $(fullPageHtml); const newMenu = $newContent.find(&#x27;#mlist-container&#x27;).html(); // 更新侧边栏容器 $(&#x27;#mlist-container&#x27;).html(newMenu); // 重新初始化 MDUI 组件（如果需要） if (window.mdui) &#123; mdui.mutation(); &#125; &#125;, error: function() &#123; console.error(&#x27;Failed to reload sidebar menu&#x27;); &#125; &#125;);&#125; 主题配置文件即博客根目录下的_config.nexmoe.yml 注意：jquery和pjax一定要使用这两个版本，不然有可能无法加载 来源：pjax实现网站无刷新化和个人遇到的无数坑 12345678slotHead: | &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.css&quot;&gt; &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery/1.8.3/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/jquery.pjax/2.0.1/jquery.pjax.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/aplayer/1.10.1/APlayer.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;/js/上面自定义的.js&quot;&gt;&lt;/script&gt;slotFooter: | &lt;div id=&quot;aplayerallpages&quot;&gt; content.jsx主题自带的劫持功能没办法作用到包含刷新页面代码的文件，因此需要修改content.jsx 文件在/node_modules/hexo-theme-nexmoe/layout/_layout/nexmoe 稍作修改套一层pjax容器即可 12345678return ( &lt;div id=&quot;pjax-container&quot; data-pjax-container&gt; &lt;div class=&quot;nexmoe-primary&quot; dangerouslySetInnerHTML=&#123;&#123; __html: body &#125;&#125; &gt;&lt;/div&gt; &lt;/div&gt;); header.ejs为了同步更新侧边导航栏的高亮部分，我们的自定义js有更新#mlist-container的内容 需要把高亮部分的代码用这个容器框起来 此文件在/node_modules/hexo-theme-nexmoe/layout/_layout/nexmoe 123456789101112&lt;div id=&quot;mlist-container&quot;&gt; &lt;div class=&quot;nexmoe-list mdui-list&quot; mdui-collapse=&quot;&#123;accordion: true&#125;&quot;&gt; &lt;% for (name in theme.menu) &#123; %&gt; &lt;a class=&quot;nexmoe-list-item mdui-list-item mdui-ripple &lt;%= is_current(theme.menu[name][0]) %&gt;&quot; href=&quot;&lt;%- url_for(theme.menu[name][0]) -%&gt;&quot; title=&quot;&lt;%= name %&gt;&quot;&gt; &lt;i class=&quot;mdui-list-item-icon nexmoefont &lt;% if (theme.menu[name][1])&#123; %&gt;&lt;%= theme.menu[name][1] %&gt;&lt;%&#125; else&#123; %&gt;&lt;%= &#x27;icon-unorderedlist&#x27; %&gt;&lt;% &#125; %&gt;&quot;&gt;&lt;/i&gt; &lt;div class=&quot;mdui-list-item-content&quot;&gt; &lt;%= name %&gt; &lt;/div&gt; &lt;/a&gt; &lt;% &#125; %&gt; &lt;/div&gt;&lt;/div&gt; 完成1hexo g &amp; hexo d 然后就OK啦 旧代码存档以下文件都在/你的博客/node_modules/hexo-theme-nexmoe/layout/中 layout.jsx由于包含跳转页面的代码在layout.jsx中，因此无法使用hexo自带的劫持功能，需要修改layout.jsx 文件头部 12345const PJAX_CONFIG = &#123; selectors: [&#x27;#pageContent&#x27;], // 指定内容替换容器``` excludes: &#x27;#aplayerContent, .mdui-drawer&#x27;, // 排除播放器和侧边栏 timeout: 8000 &#125;; 中部 123456789101112return ( &lt;html lang=&#123;language ? language.substr(0, 2) : &#x27;&#x27;&#125;&gt; &lt;head dangerouslySetInnerHTML=&#123;&#123; __html: partial(&#x27;_partial/head&#x27;) + &#x27;&lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css&quot;/&gt;&#x27; + &#x27;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js&quot;&gt;&lt;/script&gt;&#x27; + // 新增 jQuery &#x27;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js&quot;&gt;&lt;/script&gt;&#x27; + // 新增 PJAX &#x27;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js&quot;&gt;&lt;/script&gt;&#x27; + &#x27;&lt;script src=&quot;https://cdn.jsdelivr.net/npm/meting@2.0.1/dist/Meting.min.js&quot;&gt;&lt;/script&gt;&#x27; &#125;&#125; &gt;&lt;/head&gt; 如果需要修改播放器css样式，上面的https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css需要改成自己的css文件地址 1234567891011121314151617181920212223242526272829303132&lt;SearchBox &#123;...this.props&#125; /&gt; &lt;div dangerouslySetInnerHTML=&#123;&#123; __html: theme.slotFooter &#125;&#125; &gt;&lt;/div&gt; &lt;div id=&quot;aplayerContent&quot;&gt; &lt;meting-js server=&quot;netease&quot; type=&quot;playlist&quot; id=&quot;your id&quot; fixed=&quot;true&quot; order=&quot;random&quot; list-max-height=&quot;1000px&quot; lrc-type=&quot;1&quot; data-pjax-persist&gt;&lt;/meting-js&gt; &lt;/div&gt; &lt;script dangerouslySetInnerHTML=&#123;&#123; __html: ` document.addEventListener(&#x27;DOMContentLoaded&#x27;, function() &#123; // 初始化 PJAX var pjax = new Pjax($&#123;JSON.stringify(PJAX_CONFIG)&#125;); // 页面切换后保持播放器 document.addEventListener(&#x27;pjax:end&#x27;, function() &#123; if(window.aplayers &amp;&amp; window.aplayers.length &gt; 0) &#123; window.aplayers[0].toggle(); &#125; &#125;); // 重新初始化 MetingJS document.addEventListener(&#x27;pjax:complete&#x27;, function() &#123; if(typeof Meting !== &#x27;undefined&#x27;) &#123; Meting.reload(); &#125; &#125;); &#125;); ` &#125;&#125;&gt;&lt;/script&gt;&lt;/body&gt; background.jsx这个在/layout/_partial下 把&lt;div id=&quot;nexmoe-background&quot;&gt;&lt;/div&gt; 里面的内容全都套在&lt;div id=&quot;pageContent&quot;&gt;&lt;/div&gt;中 123456&lt;a href=&#123;url_for()&#125; title=&#123;config.author || config.title&#125; class=&quot;mdui-btn mdui-btn-icon&quot; data-pjax // 新增属性&gt; searchbox.jsx也在/layout/_partial下 同样在&lt;div id=&quot;nexmoe-search-space&quot;&gt;&lt;/div&gt;外面套个&lt;div id=&quot;pageContent&quot;&gt;&lt;/div&gt; 中间 1234567&lt;input class=&quot;search-input&quot; type=&quot;text&quot; placeholder=&#123; __(&#x27;search&#x27;)&#125; onInput=&quot;sinput();&quot; data-no-pjax // 新增属性/&gt; body.jsx此文件在layout/_layout/nexmoe 需要在&lt;Fragment&gt;里面&lt;div id=&quot;nexmoe-header&quot;&gt;&lt;/div&gt;外面套一层&lt;div id=&quot;pageContent&quot; data-pjax-container&gt;&lt;/div&gt; 大功告成其实挺简单的对吧，但是我对前端一点都不熟，自己一个人搞了8小时现在是15小时了"},{"title":"个人网站开通了！","path":"intro/","text":"简要介绍你们好！ 欢迎来到椛的联络站! 这里可以看到我的更多信息 如果你在访问本网站时遇到问题，可以在github上提交发现的bug，当然，也可以提交失效需补档的资源 网站作用发布教程的文字版、记录往期视频的资源链接以及随记、近况的编写 少女祈祷中……github的网站一直都很慢。嗯，至少在国内是这样 05&#x2F;25更新：更换好友的服务器，体验会好一点了"}]